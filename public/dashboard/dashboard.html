<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./dashboard.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <title>Document</title>
</head>

<body onload="obterDados()">
    <div class="dashboard-container">
        <nav class="menu-lateral">
            <div class="expandir">
                <i class="bi bi-list"></i>
            </div>
            <ul>
                <li class="item-menu">
                    <a href="../dashboard/dashboard.html">
                        <span class="icone"><i class="bi bi-columns-gap"></i></span>
                        <span class="txt-link">Dashboard</span>
                    </a>
                </li>
                <li class="item-menu">
                    <a href="../quiz/index.html">
                        <span class="icone"><i class="bi bi-controller"></i></span>
                        <span class="txt-link">Quiz</span>
                    </a>
                </li>

                <li class="item-menu">
                    <a href="a">
                        <span class="icone"><i class="bi bi-person"></i></span>
                        <span class="txt-link">Perfil</span>
                    </a>
                </li>
            </ul>
        </nav>

        <div class="caixa-conteudo">
            <div class="sessao-conteudo-dashboard">
                <section class="sessao-indicadores">
                    <div class="Porcentagem-Acerto">
                        <h2 class="titulo-porcentagem-acerto">Você Acertou:</h2>
                        <p class="conteudo-indicador" id="p_KPI_Porcentg_Acerto">1</p>
                    </div>
                    <div class="Maior-numero-Pontos">
                        <h2 class="titulo-maior-pontos">Você Acertou:</h2>
                        <p class="conteudo-indicador" id="p_KPI_Maior_Pontos">1</p>
                    </div>
                    <div class="Menor-numero-Pontos">
                        <h2 class="titulo-menor-pontos">Você Acertou:</h2>
                        <p class="conteudo-indicador" id="p_KPI_Menor_Pontos">1</p>
                    </div>
                </section>
                <!--Grafico de Acertos-->
                <div class="Grafico-Acertos">
                    <h3 class="titulo-grafico">Pontuação</h3>
                    <section class="sessao-grafico-acertos">
                        <div class="graficoAcerto">
                            <canvas id="myChart" style="height: 100%; width: 80%;"></canvas>
                        </div>
                    </section>
                </div>
            </div>
        </div>
    </div>
    <script>
        const labels = ['Média']
        const data = {
            labels: labels,
            datasets: [{
                label: 'Quantidade Pontuação em cada partida',
                data: [],
                borderWidth: 1,
            }]
        };

        const config = {
            type: 'bar',
            data: data,
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        };

        var myChart = new Chart(
            document.getElementById('myChart'),
            config,
            data
        );
    </script>
</body>

</html>

<script>
    function obterDados() {
        

        fetch(`/usuarios/obterDados`, {

            method: "GET",

            headers: {

                "Content-Type": "application/json"

            }

        })

            .then(function (resposta) {

                if (!resposta.ok) {

                    throw new Error("Erro ao obter dados");


                } else{
                    return resposta.json();
                }

                

            })

            .then(function (data) {

                console.log("Dados recebidos do servidor:", data); // Adicionado para debug



                const dataset = data.map(item => item.Pontuacao);



                myChart.data.labels = labels;

                myChart.data.datasets[0].data = dataset;



                myChart.update();

            })

            .catch(function (erro) {

                console.error("Erro ao obter Dados: ", erro);

            });

    }
</script>